<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <script>
        $(function () {
            $("#accordion").accordion({heightStyle: "content"});
            $("#setChPwd").button();
            $("#accordion1").accordion({heightStyle: "content"});
            $("#addNewDeviceForm").button();
            $("#deleteObjectSubmit").button();
            $("#addDeviceForm").submit(function (event) {
                event.preventDefault();
                if ($(this).valid()) {
                    $("#addDeviceResult").html('');
                    var values = $(this).serialize();
                    $.ajax({
                        url: "/",
                        'cache': false,
                        type: "get",
                        data: values,
                        success: function (data) {
                            $("#addDeviceResult").html(data);
                            $("#addDeviceForm").each(function () {
                                this.reset();
                            });
                            document.location.reload(true);
                        },
                        error: function () {
                            $("#addDeviceResult").html(err_add_device);
                        }
                    });
                }
            });
            $("#deleteDeviceForm").submit(function (event) {
                event.preventDefault();
                if ($(this).valid()) {
                    $("#deleteObjectResult").html('');
                    var values = $(this).serialize();
                    $.ajax({
                        url: "/",
                        'cache': false,
                        type: "get",
                        data: values,
                        success: function (data) {
                            if (data == 'EMPTY') {
                                $("#deleteObjectResult").html(err_empty_device_room);
                            } else {
                                document.location.reload(true);
                            }
                        },
                        error: function () {
                            $("#deleteObjectResult").html(err_delete_object);
                        }
                    });
                }
            });
            $("#deviceIdLoader").button().click(function () {
                $.ajax({
                    url: "/",
                    'cache': false,
                    type: "get",
                    data: "ServiceName=GetFreeDeviceId&" + Math.floor((Math.random() * 100) + 1),
                    success: function (freeId) {
                        document.getElementById("addDeviceId").value = freeId;
                    },
                    error: function () {
                        alert(err_free_deviceId);
                    }
                });
            });
            $("#changeChannelPassowrd").submit(function (event) {
                event.preventDefault();
                if ($(this).valid()) {
                    $("#changeChannelPassowrdResult").html('');
                    var values = $(this).serialize();
                    $.ajax({
                        url: "/",
                        'cache': false,
                        type: "get",
                        data: values,
                        success: function (data) {
                            $("#changeChannelPassowrdResult").html(data);
                        },
                        error: function () {
                            $("#changeChannelPassowrdResult").html(err_change_channelPwd);
                        }
                    });
                }
            });
            $("#addUser").button();
            $("#userManagementForm").submit(function (event) {
                event.preventDefault();
                if ($(this).valid()) {
                    $("#addUserResult").html('');
                    var values = $(this).serialize();
                    $.ajax({
                        url: "/",
                        'cache': false,
                        type: "get",
                        data: values,
                        success: function (data) {
                            $("#addUserResult").html(data);
                        },
                        error: function () {
                            $("#addUserResult").html(err_add_user);
                        }
                    });
                }
            });
            $("#modifyUser").button();
            $("#modifyUserForm").submit(function (event) {
                event.preventDefault();
                if ($(this).valid()) {
                    $("#modifyUserResult").html('');
                    var values = $(this).serialize();
                    $.ajax({
                        url: "/",
                        'cache': false,
                        type: "get",
                        data: values,
                        success: function (data) {
                            $("#modifyUserResult").html(data);
                        },
                        error: function () {
                            $("#modifyUserResult").html(err_change_user);
                        }
                    });
                }
            });

        });
        $(document).ready(function () {
            $("#addDeviceForm").validate({
                rules: {
                    addDeviceId: { required: true, range: [1, 255] },
                    addSubDeviceId: { range: [1, 255] },
                    addDeviceName: { required: true },
                    type: { required: true },
                    roomName: { required: true }
                },
                messages: {
                    addDeviceId: { required: err_enter_device_id, range: err_device_id_range},
                    addSubDeviceId: { range: err_subdevice_number},
                    addDeviceName: { required: err_device_name },
                    type: { required: err_device_type },
                    roomName: { required: err_device_room }
                }
            });
            $.ajax({
                url: "/",
                type: "get",
                'cache': false,
                data: "ServiceName=LoadAllRooms&" + Math.floor((Math.random() * 100) + 1),
                success: function (roomsData) {
                    rooms = roomsData.split("\n");
                    $("#addDeviceLocation").autocomplete({minLength: 0, source: rooms}).
                            focus(function () {
                                setTimeout("if ($('#addDeviceLocation').val().length == 0) $('#addDeviceLocation').autocomplete(\"search\", \"\"); ", 1);
                            });
                },
                error: function () {
                    alert(err_no_rooms);
                }
            });
            $.ajax({
                url: "/",
                'cache': false,
                type: "get",
                data: "ServiceName=DeleteObject&loadData=true&loadRooms=false&loadDevices=true&" + Math.floor((Math.random() * 100) + 1),
                success: function (data) {
                    var select = document.getElementById("deleteDeviceId");
                    var json = JSON.parse(data);
                    for (var i = 0; i < json.length; i++) {
                        var d = json[i];
                        select.options.add(new Option(d.name, d.id));
                    }
                },
                error: function () {
                    alert(err_get_objects);
                }
            });
            $.ajax({
                url: "/",
                'cache': false,
                type: "get",
                data: "ServiceName=DeleteObject&loadData=true&loadRooms=true&loadDevices=false&" + Math.floor((Math.random() * 100) + 1),
                success: function (data) {
                    var select = document.getElementById("deleteRoomId");
                    var json = JSON.parse(data);
                    for (var i = 0; i < json.length; i++) {
                        var d = json[i];
                        select.options.add(new Option(d.name));
                    }
                },
                error: function () {
                    alert(err_get_objects);
                }
            });
            $("#changeChannelPassowrd").validate({
                rules: {
                    channel: { required: true, range: [1, 83] },
                    password: { required: true, exactlength: 9 }
                },
                messages: {
                    channel: { required: err_channel_empty, range: err_channel_range },
                    password: { required: err_pwd_empty, exactlength: err_pwd_range }
                }
            });
            $.ajax({
                url: "/",
                'cache': false,
                type: "get",
                data: "ServiceName=LoadChannelPassword&" + Math.floor((Math.random() * 100) + 1),
                success: function (data) {
                    document.getElementById("channel").value = data.split("\n")[0];
                    document.getElementById("password").value = data.split("\n")[1];
                },
                error: function () {
                    alert(err_get_channel_pwd);
                }
            });
            $.ajax({
                url: "/",
                'cache': false,
                type: "get",
                data: "ServiceName=UserManagementService&loadUsers=true&" + Math.floor((Math.random() * 100) + 1),
                success: function (data) {
                    var select = document.getElementById("userNameModify");
                    var json = JSON.parse(data);
                    for (var i = 0; i < json.length; i++) {
                        var d = json[i];
                        select.options.add(new Option(d.userName));
                    }
                },
                error: function () {
                    alert(err_get_channel_pwd);
                }
            });
            document.getElementById('setChPwd').value = setChPwd_form;
            document.getElementById('addUser').value = adduser_form;
            document.getElementById('modifyUser').value = modifyuser_form;
            setLabel("channel_password_cfg");
            setLabel("channel_device");
            setLabel("password_device");
            document.getElementById('channel').title = channel_device_desc;
            document.getElementById('password').title = password_device_desc;
            setLabel("wifi_configuration");
            setLabel("user_management");
            setLabel("user_management_text");
            setLabel("user_name");
            setLabel("user_password");
            setLabel("user_confirm_password");
            setLabel("group_id");
            var selectGROUP = document.getElementById("groupId");
            selectGROUP.options[1].text = admin_label;
            selectGROUP.options[2].text = reader_label;
            setLabel("modify_user_text");
            setLabel("groupId2");
            setLabel("group_id_2");
            setLabel("user_name_modify");
            setLabel("user_password_modify_actual");
            setLabel("user_confirm_password_modify");
            setLabel("user_confirm_password_modify_confirm");
            setLabel("add_new_device");
            setLabel("add_new_device_desc");
            setLabel("new_device_id");
            setLabel("new_subdevice_id");
            document.getElementById('addDeviceId').title = new_device_id_desc;
            document.getElementById('addSubDeviceId').title = new_subdevice_id_desc;
            document.getElementById('addDeviceName').title = new_device_name_desc;
            document.getElementById('addDeviceLocation').title = room_name_desc;
            document.getElementById('deviceIdLoader').value = get_device_id;
            document.getElementById('addNewDeviceForm').value = add_new_device_form;
            document.getElementById('deleteObjectSubmit').value = delete_object_submit;
            setLabel("new_device_name");
            setLabel("room_name");
            setLabel("device_type");
            setLabel("LightAlarmDevice");
            setLabel("TemperatureSensor");
            setLabel("SimpleSwitch");
            setLabel("HeatingHeader");
            setLabel("BlindsControllerDevice");
            setLabel("Thermostat");
            setLabel("ThermostatWithSwitchAndTempSensorDevice");
            setLabel("delete_device_cfg");
            setLabel("delete_device");
            setLabel("delete_room");
            setLabel("deleteObjectSubmit");
            setLabel("user_management");
        });

    </script>
</head>
<body>
<div id="accordion">

    <h3><span id="add_new_device"></span></h3>
    <div>
        <p><span id="add_new_device_desc"></span></p>
        <form id="addDeviceForm">
            <input type="hidden" name="ServiceName" value="AddNewDevice"/>
            <table style="text-align:left;">
                <tr>
                    <td><label for="addDeviceId"><span id="new_device_id"></span></label></td>
                    <td><input name="addDeviceId" id="addDeviceId"/></td>
                    <td><input id="deviceIdLoader"/></td>
                </tr>
                <tr>
                    <td><label for="addSubDeviceId"><span id="new_subdevice_id"></span></label></td>
                    <td><input name="addSubDeviceId" id="addSubDeviceId"/></td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td><label for="addDeviceName"><span id="new_device_name"></span></label></td>
                    <td><input name="addDeviceName" id="addDeviceName"/></td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td><label for="addDeviceLocation"><span id="room_name"></span></label></td>
                    <td><input name="roomName" id="addDeviceLocation"/></td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td><label for="device_type"><span id="device_type"></span></label></td>
                    <td>
                        <select name="type" id="typeOfTheDevice">
                            <option id="LightAlarmDevice" value="1"></option>
                            <option id="TemperatureSensor" value="2"></option>
                            <option id="SimpleSwitch" value="3"></option>
                            <option id="HeatingHeader" value="4"></option>
                            <option id="BlindsControllerDevice" value="5"></option>
                            <option id="Thermostat" value="6"></option>
                            <option id="ThermostatWithSwitchAndTempSensorDevice" value="8"></option>
                        </select></td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                    <td><input id="addNewDeviceForm" type="submit"/></td>
                    <td>
                        <div id="addDeviceResult">&nbsp;</div>
                    </td>
                </tr>
            </table>
        </form>
    </div>

    <h3><span id="delete_device_cfg"></span></h3>
    <div>
        <p><span id="delete_device_cfg_text"></span></p>
        <form id="deleteDeviceForm">
            <table>
                <tr>
                    <td><label for="deleteDeviceId"><span id="delete_device"></span></label></td>
                    <td>
                        <select width="100%" id="deleteDeviceId" name="deleteDeviceName">
                            <option value="0">&nbsp;</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><label for="deleteRoomId"><span id="delete_room"></span></label></td>
                    <td>
                        <select width="100%" id="deleteRoomId" name="deleteRoomName">
                            <option value="0">&nbsp;</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><input type="hidden" name="ServiceName" value="DeleteObject"/><input id="deleteObjectSubmit"
                                                                                             type="submit"/></td>
                    <td>
                        <div id="deleteObjectResult">&nbsp;</div>
                    </td>
                </tr>
            </table>
        </form>
    </div>

    <h3><span id="user_management"></span></h3>
    <div>
        <table>
            <tr>
                <td>
                    <h4 id="user_management_text"></h4>
                    <form id="userManagementForm">
                        <table>
                            <tr>
                                <td><label for="user_name"><span id="user_name"></span></label></td>
                                <td><input name="userName" id="userName"/></td>
                            </tr>
                            <tr>
                                <td><label for="user_password"><span id="user_password"></span></label></td>
                                <td><input type="password" name="userPassword" id="userPassword"/></td>
                            </tr>
                            <tr>
                                <td><label for="user_confirm_password"><span id="user_confirm_password"></span></label></td>
                                <td><input type="password" name="userConfirmPassword" id="userConfirmPassword"/></td>
                            </tr>
                            <tr>
                                <td><label for="group_id"><span id="group_id"></span></label></td>
                                <td>
                                    <select width="100%" id="groupId" name="groupId">
                                        <option value="0">&nbsp;</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="hidden" name="ServiceName" value="UserManagementService"/>
                                    <input type="hidden" name="method" value="addUser"/>
                                    <input id="addUser" type="submit"/></td>
                                <td>
                                    <div id="addUserResult">&nbsp;</div>
                                </td>
                            </tr>
                        </table>
                    </form>
                </td>
                <td>
                    <br />
                </td>
                <td>
                    <h4 id="modify_user_text"></h4>
                    <form id="modifyUserForm">
                        <table>
                            <tr>
                                <td><label for="user_name_modify"><span id="user_name_modify"></span></label></td>
                                <td>
                                    <select width="100%" id="userNameModify" name="userNameModify">
                                        <option value="0">&nbsp;</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td><label for="user_password_modify_actual"><span id="user_password_modify_actual"></span></label></td>
                                <td><input type="password" name="userPasswordModifyActual" id="userPasswordModifyActual"/></td>
                            </tr>
                            <tr>
                                <td><label for="user_confirm_password_modify"><span id="user_confirm_password_modify"></span></label></td>
                                <td><input type="password" name="userConfirmPasswordModify" id="userConfirmPasswordModify"/></td>
                            </tr>
                            <tr>
                                <td><label for="user_confirm_password_modify_confirm"><span id="user_confirm_password_modify_confirm"></span></label></td>
                                <td><input type="password" name="userConfirmPasswordModifyConfirm" id="userConfirmPasswordModifyConfirm"/></td>
                            </tr>
                            <tr>
                                <td><label for="group_id_2"><span id="group_id_2"></span></label></td>
                                <td>
                                    <select width="100%" id="groupId2" name="groupId2">
                                        <option value="0">&nbsp;</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="hidden" name="ServiceName" value="UserManagementService"/>
                                    <input type="hidden" name="method" value="modifyUser"/>
                                    <input id="modifyUser" type="submit"/></td>
                                <td>
                                    <div id="modifyUserResult">&nbsp;</div>
                                </td>
                            </tr>
                        </table>
                    </form>
                </td>
            </tr>
        </table>
    </div>

    <h3><span id="channel_password_cfg"></span></h3>
    <div>
        <p><span id="channel_password_cfg_text"></span></p>
        <form id="changeChannelPassowrd">
            <table>
                <tr>
                    <td><label for="channel"><span id="channel_device"></span></label></td>
                    <td><input name="channel" id="channel"/></td>
                </tr>
                <tr>
                    <td><label for="password"><span id="password_device"></span></label></td>
                    <td><input name="password" id="password"/></td>
                </tr>
                <tr>
                    <td><input type="hidden" name="ServiceName" value="ChangeChannelPwd"/><input id="setChPwd"
                                                                                                 type="submit"/></td>
                    <td>
                        <div id="changeChannelPassowrdResult">&nbsp;</div>
                    </td>
                </tr>
            </table>
        </form>
    </div>

    <h3><span id="wifi_configuration"></span></h3>
    <div>
    </div>

</div>
</body>
</html>