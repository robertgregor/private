<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Remote-home GUI</title>
<link rel="stylesheet" href="jquery-ui-1.10.2.custom.css" />
<link rel="stylesheet" href="style.css" />
<link rel="stylesheet" href="schedulers.css" />
<link rel="stylesheet" type="text/css" href="jchartfx.css" />
<script type="text/javascript" src="jquery-1.9.1.js"></script>
<script type="text/javascript" src="jquery-ui-1.10.2.custom.js"></script>
<script type="text/javascript" src="jquery.validate.js"></script>
<script type="text/javascript" src="jquery.i18n.properties-min-1.0.9.js"></script>
<script type="text/javascript" src="schedulers.js"></script>
<script type="text/javascript" src="jchartfx.system.js"></script>
<script type="text/javascript" src="jchartfx.coreBasic.js"></script>
<script type="text/javascript" src="jchartfx.ui.js"></script>
<script type="text/javascript" src="jchartfx.advanced.js"></script>
<script>
var addTabJs = null;
var isMouseDown = false;
function changeLang(lang) {
    jQuery.i18n.properties({
        name: 'Messages', 
        path: '', 
        mode: 'both',
        language: lang, 
        callback: function() {
        }
    });
}
function setLabel(lbl) {
    document.getElementById(lbl).innerHTML = jQuery.i18n.prop(lbl);
}
function setLabelBasedOnId(id, lbl) {
    document.getElementById(id).innerHTML = jQuery.i18n.prop(lbl);
}
$(function() {
  $("#logout").button();
    $("#logout").button().click(function () {
        $.ajax({
            url: "/",
            'cache': false,
            type: "get",
            data: "ServiceName=UserManagementService&logout=true&" + Math.floor((Math.random() * 100) + 1),
            success: function (freeId) {
                document.location.reload(true);
            },
            error: function () {
                alert(err_logout);
            }
        });
    });
  var tabs = $( "#tabs" ).tabs();
  changeLang('PREFLANG');
  //$( document ).tooltip();
  $( "input[type=submit], a, button" ).button();
  $('tbody tr').hover(function() { $(this).toggleClass('ui-state-highlight'); });
  function addTab(label) {
    li = "<li><a href='?ServiceName=LoadRoomPage&room="+encodeURIComponent(label)+"&"+Math.floor((Math.random()*100)+1)+"'>"+label+"</a></li>",
    tabs.find( ".ui-tabs-nav" ).append( li );
    tabs.tabs( "refresh" );
  }
  addTabJs = addTab;
  $( "#tabs" ).tabs({      
      beforeLoad: function( event, ui ) {        
          ui.jqXHR.error(function() {          
              ui.panel.html("Couldn't load this tab." );
          });
      }
  });
  jQuery.validator.addMethod("exactlength", function(value, element, param) { return this.optional(element) || value.length == param; },
  jQuery.format("Please enter exactly {0} characters."));
  $('body').append('<div id="ajaxBusy"></div>');
  $(document).ajaxStart(function () {
    $('#ajaxBusy').show();
  }).ajaxStop(function () {
    $('#ajaxBusy').hide();
  });
});
$(document)
    .mouseup(function () {
      isMouseDown = false;
});
$(document).ready(function(){
  $.ajax({
      url: "/",
      type: "get",
      'cache' : false,
      data: "ServiceName=LoadAllRooms&"+Math.floor((Math.random()*100)+1),
      success: function(roomsData) {
           rooms = roomsData.split("\n");
           for (var i=0; i<rooms.length; i++) {
               if (rooms[i].length > 1) {
                    addTabJs(rooms[i]);
               }
           }
           $( "#tabs" ).find( ".ui-tabs-nav" ).append( "<li><a href='deviceManagement.html'>"+main_device_mngmt+"</a></li>" );
           $( "#tabs" ).find( ".ui-tabs-nav" ).append( "<li><a href='systemManagement.html'>"+main_system_mngmt+"</a></li>" );
           $( "#tabs" ).tabs( "refresh" );
           $("#tabs").tabs("option", {"active": 0});
      },
      error:function(){
          alert(err_no_rooms);
      }   
  });
});
</script>
</head>
<body>
<p align="left"><input id="logout" type="submit"/>Logout</p>
<p align="right"><img src="cz.png" onclick="changeLang('cz');document.location.reload(true);"/><img src="gb.png" onclick="changeLang('en');document.location.reload(true);"/></p>
<div id="tabs">
<ul>
</ul>
</div>
</body>
</html>